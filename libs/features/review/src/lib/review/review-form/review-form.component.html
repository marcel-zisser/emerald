<div class="review-container">
  <div class="criteria-container">
    @for (group of review()?.checklist?.criteriaGroups; track group.uuid) {
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            {{ group.description }}
          </mat-panel-title>
        </mat-expansion-panel-header>

        <mat-accordion>
          <div class="criteria-container">
            @for (criterion of group?.criteria; track criterion.uuid) {
              <mat-card (click)="selectCriterion(criterion)">
                <mat-card-content class="criterion">
                  <span>{{ criterion.description }} | {{ criterion?.reviewResults?.[0]?.status }}</span>
                </mat-card-content>
              </mat-card>
            }
          </div>
        </mat-accordion>
      </mat-expansion-panel>
    } @empty {
      Nothing to show.
    }
  </div>
  <div class="review-panel">
    @if (selectedCriterion()) {
      <mat-card>
        <mat-card-header class="card-header">
          {{ selectedCriterion()?.description }}
        </mat-card-header>
        <mat-card-content>
          <form [formGroup]="criterionForm">
            <div class="form-field">
              <mat-label class="outside-label">Comments</mat-label>
              <mat-form-field appearance="fill">
                <textarea matInput formControlName="comments"></textarea>
              </mat-form-field>
            </div>

            <div class="button-container">
              <button mat-fab extended="true" class="status-button pass" (click)="setStatus(CriterionStatus.Pass)">
                <mat-icon>check</mat-icon>
                Pass
              </button>
              <button mat-fab extended="true" class="status-button fail" (click)="setStatus(CriterionStatus.Fail)">
                <mat-icon>close</mat-icon>
                Fail
              </button>
            </div>
          </form>
        </mat-card-content>
      </mat-card>
    }
  </div>
</div>
